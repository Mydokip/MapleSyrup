<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <title>메이플시럽</title>
    <link rel="stylesheet" href="app.css" type="text/css" />
	<meta name="viewport" content="width=device-width" />
	<style>
	html, body, #contentDiv { height: 100%; margin: 0; }
	</style>
    <link rel="stylesheet" href="https://unpkg.com/dialog-polyfill/dialog-polyfill.css" />
    <script src="https://unpkg.com/dialog-polyfill/dialog-polyfill.js"></script>
    <script src="lib/maplesyrup.js"></script>
    <script>
        function syrupifySingleLine() {
            try {
                const resultText = MapleSyrup.convert(text.value.replace(/\s/g, ""));
                result.textContent = resultText;
            } catch (err) {
                alert(`오류가 발생했습니다: ${err}`);
            }
        }

        function syrupifyMultiLine() {
            try {
            const resultTexts = MapleSyrup.convertAsArray(text.value.replace(/\s/g, ""));
            result.textContent = resultTexts.join("\n\n");
            } catch (err) {
                alert(`오류가 발생했습니다: ${err}`);
            }
        }

        document.addEventListener("DOMContentLoaded", async () => {
            agreeButton.addEventListener("click", () => {
                dialog.close();
            });
            dialogPolyfill.registerDialog(dialog);
            dialog.showModal();
            dialog.addEventListener("cancel", ev => ev.preventDefault());
            dialog.scrollTop = 0;
        });
    </script>
</head>
<body>
    <div id="contentDiv" class="main">
        <div>
            <h1>메이플시럽</h1>
            <p>
                마비노기 MML 악보를 메이플스토리 2에서 연주할 수 있게 일부 수정해주는 툴입니다. 변환 결과는 개인적으로만 이용해주세요!<br/>
                문의는 <a href="https://twitter.com/saschanaz"/>트위터 @SaschaNaz</a> 또는 <a href="https://github.com/saschanaz/MapleSyrup">GitHub 레포</a>로!
            </p>
        </div>

        <textarea id="text" class="flexone" placeholder="MML@로 시작하는 코드를 넣으세요"></textarea>
        <div>
            <input type="button" value="한 줄로 변환" onclick="syrupifySingleLine();" /><input type="button" value="따로따로 변환" onclick="syrupifyMultiLine();" />
        </div>
        <textarea id="result" class="flexone" placeholder="변환 결과가 이곳에 나타납니다"></textarea>
    </div>
    <dialog id="dialog">
        <p>주의!</p>
        <p>'메이플시럽'은 메이플스토리2 유저들이 기존의 마비노기용 악보를 개인적인 용도로 쉽게 즐길 수 있도록 만든 도구입니다.</p>
        <p>이용자는 원저작자 및 2차 창작자의 동의 없이 이 도구를 이용해 만든 악보로 수익을 창출하거나 다른 사이트에 재배포해서는 안 됩니다.</p>
        <p>이용자는 악보 변환 결과가 기대 이하라는 이유로 저작자에게 근거 없는 비방을 해서는 안 됩니다. 마비노기와 메이플스토리2의 악기 소리가 서로 다르기 때문에 변환 결과가 원본 악보와 다소 다를 수 있음을 유의해 주세요.</p>
        <p>도구 자체의 버그로 잘못된 악보가 만들어질 수 있습니다. 소리가 지나치게 이상한 경우 또는 변환 오류 메시지가 발생할 경우 도구 개발자에게 문의 바랍니다.</p>
        <p class="center">
            <input id="agreeButton" type="button" value="동의" />
        </p>
    </dialog>
</body>
</html>
